{% extends "base.html" %}

{% block content %}
<h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</h2>

<form method="POST">
  <div class="row mb-3">
    <div class="col-md-6">
      <label class="form-label">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</label>
      <select name="employee_id" class="form-control" required>
        {% for e in employees %}
        <option value="{{ e.id }}" {% if e.id == cert.employee_id %}selected{% endif %}>
          {{ e.full_name }}
        </option>
        {% endfor %}
      </select>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-6">
      <label class="form-label">–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä</label>
      <input type="text" name="serial_number" class="form-control" value="{{ cert.serial_number }}" required>
    </div>
    <div class="col-md-6">
      <label class="form-label">–¢–∏–ø —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</label>
      <select name="certificate_type" class="form-control">
        <option value="–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π" {% if cert.certificate_type == "–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π" %}selected{% endif %}>–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
        <option value="–ù–µ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π" {% if cert.certificate_type == "–ù–µ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π" %}selected{% endif %}>–ù–µ–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
        <option value="–ö–≠–ü" {% if cert.certificate_type == "–ö–≠–ü" %}selected{% endif %}>–ö–≠–ü</option>
        <option value="–£–¶" {% if cert.certificate_type == "–£–¶" %}selected{% endif %}>–£–¶</option>
      </select>
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">–ò–∑–¥–∞—Ç–µ–ª—å (Issuer)</label>
    <input type="text" name="issuer" class="form-control" value="{{ cert.issuer }}" required>
  </div>

  <div class="mb-3">
    <label class="form-label">–°—É–±—ä–µ–∫—Ç (Subject)</label>
    <input type="text" name="subject" class="form-control" value="{{ cert.subject }}" required>
  </div>

  <div class="row mb-3">
    <div class="col-md-6">
      <label class="form-label">–î–µ–π—Å—Ç–≤—É–µ—Ç —Å</label>
      <input type="datetime-local" name="valid_from" class="form-control"
             value="{{ cert.valid_from.strftime('%Y-%m-%dT%H:%M') if cert.valid_from else '' }}" required>
    </div>
    <div class="col-md-6">
      <label class="form-label">–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</label>
      <input type="datetime-local" name="valid_to" class="form-control"
             value="{{ cert.valid_to.strftime('%Y-%m-%dT%H:%M') if cert.valid_to else '' }}" required>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-6">
      <label class="form-label">SHA-1 –û—Ç–ø–µ—á–∞—Ç–æ–∫</label>
      <input type="text" name="thumbprint_sha1" class="form-control" value="{{ cert.thumbprint_sha1 }}">
    </div>
    <div class="col-md-6">
      <label class="form-label">SHA-256 –û—Ç–ø–µ—á–∞—Ç–æ–∫</label>
      <input type="text" name="thumbprint_sha256" class="form-control" value="{{ cert.thumbprint_sha256 }}">
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">–û—Ç–∫—Ä—ã—Ç—ã–π –∫–ª—é—á (PEM)</label>
    <textarea name="public_key" class="form-control" rows="4">{{ cert.public_key }}</textarea>
  </div>

  <div class="mb-3">
    <label class="form-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–∞ (Key Usage)</label>
    <input type="text" name="key_usage" class="form-control" value="{{ cert.key_usage }}">
  </div>

  <div class="mb-3">
    <label class="form-label">–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ç–æ–∫–µ–Ω, HSM –∏ —Ç.–ø.)</label>
    <input type="text" name="storage_location" class="form-control" value="{{ cert.storage_location }}">
  </div>

  <div class="mb-3">
    <label class="form-label">–ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫ PIN-–∫–æ–¥—É</label>
    <input type="text" name="pin_code_hint" class="form-control" value="{{ cert.pin_code_hint }}">
  </div>

  <div class="mb-3">
    <label class="form-label">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
    <textarea name="notes" class="form-control" rows="3">{{ cert.notes }}</textarea>
  </div>

  <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <a href="{{ url_for('index') }}" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
</form>
{% endblock %}
<!-- templates/view.html -->
{% extends "base.html" %}

{% block content %}
<h2>üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</h2>

<div class="card">
  <div class="card-body">
    <h5 class="card-title">{{ cert.full_name }}</h5>
    <p class="card-text text-muted">{{ cert.position }} ‚Ä¢ {{ cert.department }}</p>

    <table class="table table-bordered mt-3">
      <tr>
        <th>–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä</th>
        <td><code>{{ cert.serial_number }}</code></td>
      </tr>
      <tr>
        <th>–¢–∏–ø —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</th>
        <td>{{ cert.certificate_type }}</td>
      </tr>
      <tr>
        <th>–ò–∑–¥–∞—Ç–µ–ª—å (Issuer)</th>
        <td><pre class="bg-light p-2 rounded">{{ cert.issuer }}</pre></td>
      </tr>
      <tr>
        <th>–°—É–±—ä–µ–∫—Ç (Subject)</th>
        <td><pre class="bg-light p-2 rounded">{{ cert.subject }}</pre></td>
      </tr>
      <tr>
        <th>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</th>
        <td>
          {{ cert.valid_from.strftime('%d.%m.%Y %H:%M') }} ‚Äî 
          {{ cert.valid_to.strftime('%d.%m.%Y %H:%M') }}
        </td>
      </tr>
      <tr>
        <th>–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π</th>
        <td>
          {% if days_left is none %}
            <span class="badge bg-secondary">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
          {% elif days_left < 0 %}
            <span class="badge bg-danger">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω ({{ days_left }})</span>
          {% elif days_left <= 7 %}
            <span class="badge bg-warning text-dark">–°–∫–æ—Ä–æ –∏—Å—Ç–µ–∫–∞–µ—Ç ({{ days_left }})</span>
          {% else %}
            <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω ({{ days_left }})</span>
          {% endif %}
        </td>
      </tr>
      <tr>
        <th>SHA-1 –û—Ç–ø–µ—á–∞—Ç–æ–∫</th>
        <td><code>{{ cert.thumbprint_sha1 }}</code></td>
      </tr>
      <tr>
        <th>SHA-256 –û—Ç–ø–µ—á–∞—Ç–æ–∫</th>
        <td><code>{{ cert.thumbprint_sha256 }}</code></td>
      </tr>
      <tr>
        <th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª—é—á–∞</th>
        <td>{{ cert.key_usage or "‚Äî "}}</td>
      </tr>
      <tr>
        <th>–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è</th>
        <td>{{ cert.storage_location or "‚Äî "}}</td>
      </tr>
      <tr>
        <th>–ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫ PIN</th>
        <td><em>{{ cert.pin_code_hint or "–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}</em></td>
      </tr>
      <tr>
        <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</th>
        <td>{{ cert.notes or "‚Äî" }}</td>
      </tr>
    </table>

    <div class="mt-3">
      <a href="{{ url_for('edit', cert_id=cert.id) }}" class="btn btn-warning">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
      <a href="{{ url_for('delete', cert_id=cert.id) }}" class="btn btn-danger"
         onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
      <a href="{{ url_for('index') }}" class="btn btn-secondary">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// –î–æ–±–∞–≤–∏–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
window.now = new Date("{{ now().isoformat() }}");
</script>
{% endblock %}